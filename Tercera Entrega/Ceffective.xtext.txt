// automatically generated by Xtext
grammar org.xtext.example.ceffective.Ceffective with org.eclipse.xtext.common.Terminals

import "https://www.uniandes.edu.co/ceffective" 
import "http://www.eclipse.org/emf/2002/Ecore" as ecore



/**
 * ROOT
 */
Ceffective returns Ceffective:
	{Ceffective}
	'InfraestructuraCeffective'
	(nombre=EString)?
	OBJECT_START
		('proveedorNube' EQUALS proveedorNube=ProveedorNube SEMICOLON)?
	OBJECT_END
	;


/**
 * PROVEEDOR NUBE
 */
ProveedorNube returns ProveedorNube:
	OBJECT_START
		'tipoProveedor' EQUALS nombre=EString SEMICOLON
		
		'autenticacionUsuario' EQUALS
				autenticacionUsuario+=AutenticacionUsuario (COMA
				autenticacionUsuario+=AutenticacionUsuario)* SEMICOLON
		
		('ambientes' EQUALS
			LIST_START
			 ambientedespliegue+=AmbienteDespliegue ( COMA ambientedespliegue+=AmbienteDespliegue)*
		 	LIST_END
		)?
		
	OBJECT_END;

	
/**
 * AUTENTICACION USUARIO
 */
AutenticacionUsuario returns AutenticacionUsuario:
	AutenticacionBasica | AutenticacionFirma | AutenticacionUsuario_Impl;

AutenticacionUsuario_Impl returns AutenticacionUsuario:
	{AutenticacionUsuario}
	'AutenticacionUsuario'
	OBJECT_START
		('usuario' EQUALS usuario=EString SEMICOLON)? 
		('correo' EQUALS correo=EString SEMICOLON)?
	OBJECT_END;
	
Email:
	ID '@' ID '.' ID
;
	
AutenticacionBasica returns AutenticacionBasica:
	{AutenticacionBasica}
	OBJECT_START
		('usuario' EQUALS usuario=EString SEMICOLON)?
		'correo' EQUALS correo=EString SEMICOLON
		('password' EQUALS password=EString SEMICOLON)?
	OBJECT_END;

AutenticacionFirma returns AutenticacionFirma:
	{AutenticacionFirma}
	OBJECT_START
		'accessId' EQUALS accessId=EString SEMICOLON
		'secret' EQUALS secret=EString SEMICOLON
		('usuario' EQUALS usuario=EString SEMICOLON)?
		('correo' EQUALS correo=EString SEMICOLON)?
	OBJECT_END;


/**
 * AMBIENTE DE DESPLIEGUE
 */
AmbienteDespliegue returns AmbienteDespliegue:
	{AmbienteDespliegue}
	OBJECT_START
		('ambiente' EQUALS ambiente=TipoAmbiente SEMICOLON)?
		('nombre' EQUALS nombre=EString SEMICOLON)?
		
		('vpcs' EQUALS 
			LIST_START
			 vpc+=VPC ( COMA vpc+=VPC)* 
			LIST_END
		)?
		
		('securityresource' EQUALS
			LIST_START
				mecanismoseguridad+=MecanismoSeguridad ( COMA mecanismoseguridad+=MecanismoSeguridad)* 
			LIST_END
		 )?
		
		('recursos'  EQUALS
			LIST_START
				recursos+=Recurso ( COMA recursos+=Recurso)* 
			LIST_END
		)?
		
		(
			'conexiones' EQUALS 
				LIST_START
				 Conexion ( COMA Conexion )*
				LIST_END
		)?
		
	OBJECT_END
	;

enum TipoAmbiente returns TipoAmbiente:
	IST = 'IST' | QA = 'QA' | NFT = 'NFT' | PRD = 'PRD'
;


/**
 * CONEXIONES
 */
Conexion:
	OBJECT_START
		'recurso1' EQUALS ID SEMICOLON
		'recurso2' EQUALS ID SEMICOLON
	OBJECT_END
;

/**
 * VPC
 */
VPC returns VPC:
	{VPC}
	OBJECT_START
		('nombre' EQUALS nombre=ID SEMICOLON)?
		'id' EQUALS name=ID SEMICOLON
		('cidrBlock' EQUALS cidrBlock=EString SEMICOLON)?
	OBJECT_END
	;

FQN: ID ("." ID)*;

/**
 * MECANISMOS DE SEGURIDAD
 */
MecanismoSeguridad returns MecanismoSeguridad:
	Subred | InternetGateway | GrupoSeguridad;

Subred returns Subred:
	{Subred}
	OBJECT_START
		'nombre' EQUALS nombre=EString SEMICOLON
		('zonaNombre' EQUALS zonaNombre=EString SEMICOLON)?
		('zonaDisponibilidad' EQUALS zonaDisponibilidad=EString SEMICOLON)?
		'id' EQUALS id=EString SEMICOLON
		'cidrBlock' EQUALS cidrBlock=EString SEMICOLON
		('vpc' EQUALS vpc=[VPC|EString] SEMICOLON)?
	OBJECT_END;

InternetGateway returns InternetGateway:
	{InternetGateway}
	OBJECT_START
		'nombre' EQUALS nombre=EString SEMICOLON
		('zonaNombre' EQUALS zonaNombre=EString SEMICOLON)?
		('zonaDisponibilidad' EQUALS zonaDisponibilidad=EString SEMICOLON)?
		'id' EQUALS id=EString SEMICOLON
		('vpc' EQUALS vpc=[VPC|FQN] SEMICOLON )?
	OBJECT_END;

GrupoSeguridad returns GrupoSeguridad:
	{GrupoSeguridad}
	OBJECT_START
		'nombre' EQUALS nombre=EString SEMICOLON
		('zonaNombre' EQUALS zonaNombre=EString SEMICOLON)?
		('zonaDisponibilidad' EQUALS zonaDisponibilidad=EString SEMICOLON)?
		'id' EQUALS id=EString SEMICOLON
		('descripcion' EQUALS descripcion=EString SEMICOLON)?
		('vpc' EQUALS vpc=[VPC|EString] SEMICOLON)?
		'reglas' EQUALS 
			LIST_START
				reglas+=Regla ( COMA reglas+=Regla)* 
			LIST_END
					 
	OBJECT_END;

Regla returns Regla:
	{Regla}
	OBJECT_START
		('tipo' EQUALS tipo=EString SEMICOLON)?
		('protocolo' EQUALS protocolo=EString SEMICOLON)?
		('puerto' EQUALS puerto=EString SEMICOLON)?
		('origen' EQUALS origen=EString SEMICOLON)?
		('descripcion' EQUALS descripcion=EString SEMICOLON)?
		'direccion' EQUALS direccion=DireccionRegla SEMICOLON
	OBJECT_END;

enum DireccionRegla returns DireccionRegla:
	ENTRADA = 'ENTRADA' | SALIDA = 'SALIDA'
;



/**
 * RECURSOS
 */
Recurso returns Recurso:
	ServidorAplicaciones | Almacenamiento | ServidorBD | Servidor_Impl ;
	
Servidor_Impl returns Servidor:
'Servidor'
OBJECT_START
	('nombre' EQUALS nombre=EString SEMICOLON)?
	('zonaDisponibilidad' EQUALS zonaDisponibilidad=EString SEMICOLON)?
	('zonaNombre' EQUALS zonaNombre=EString SEMICOLON)?
	('id' EQUALS id=EString SEMICOLON)?
	('tamano' EQUALS tamano=TamanoServidor SEMICOLON)?
	('recursos'  EQUALS '(' recursos+=[Recurso|EString] ( COMA recursos+=[Recurso|EString])* ')' SEMICOLON )? 
	'vpc' EQUALS vpc=[VPC|EString] SEMICOLON
OBJECT_END;

ServidorAplicaciones returns ServidorAplicaciones:
	OBJECT_START
		'nombre' EQUALS nombre=EString SEMICOLON
		('zonaDisponibilidad' EQUALS zonaDisponibilidad=EString SEMICOLON)?
		('zonaNombre' EQUALS zonaNombre=EString SEMICOLON)?
		'id' EQUALS id=EString SEMICOLON
		'dimension' EQUALS tamano=TamanoServidor SEMICOLON
		('sistemaOperativo' EQUALS sistemaOperativo=EString SEMICOLON)?
		('recursos' EQUALS '(' recursos+=[Recurso|EString] ( COMA recursos+=[Recurso|EString])* ')' SEMICOLON )? 	//TODO CONEXIONES 
		('vpc' EQUALS vpc=[VPC|EString] SEMICOLON)?
	OBJECT_END;

Almacenamiento returns Almacenamiento:
	OBJECT_START
		('nombre' EQUALS nombre=EString SEMICOLON)?
		('zonaDisponibilidad' EQUALS zonaDisponibilidad=EString SEMICOLON)?
		('zonaNombre' EQUALS zonaNombre=EString SEMICOLON)?
		('id' EQUALS id=EString SEMICOLON)?
		'gigas' EQUALS tamanoInicial=EFloat SEMICOLON
		('recursos' EQUALS '(' recursos+=[Recurso|EString] ( COMA recursos+=[Recurso|EString])* ')' SEMICOLON)? 	//TODO CONEXIONES
		('vpc' EQUALS vpc=[VPC|EString] SEMICOLON)?
	OBJECT_END;

ServidorBD returns ServidorBD:
	OBJECT_START
		'nombre' EQUALS nombre=EString SEMICOLON
		('zonaDisponibilidad' EQUALS zonaDisponibilidad=EString SEMICOLON)?
		('zonaNombre' EQUALS zonaNombre=EString SEMICOLON)?
		'id' EQUALS id=EString SEMICOLON
		'dimension' EQUALS tamano=TamanoServidor SEMICOLON
		'tipo' EQUALS tipo=TipoBaseDatos SEMICOLON
		('sistemaManejador' EQUALS sistemaManejador=EString SEMICOLON)?
		('recursos' EQUALS '(' recursos+=[Recurso|EString] ( COMA recursos+=[Recurso|EString])* ')' SEMICOLON )? 	//TODO CONEXIONES
		('vpc' EQUALS vpc=[VPC|EString] SEMICOLON)?
	OBJECT_END;

enum TamanoServidor returns TamanoServidor:
	Micro = 'Micro' | Small = 'Small' | Medium = 'Medium' | Large = 'Large'
;

EFloat returns ecore::EFloat:
'-'? INT? '.' INT (('E'|'e') '-'? INT)?
;

enum TipoBaseDatos returns TipoBaseDatos:
	Relacional = 'Relacional' | NoSql = 'NoSql'
;

					
			
EString returns ecore::EString:
	STRING | ID;
		
				
				
/*
 * TERMINALES
*/


terminal EQUALS:
	"=";

terminal SEMICOLON:
	";";
	
terminal LIST_START:
	"[";
	
terminal LIST_END:
	"]";
	
terminal COMA:
	",";
	
terminal OBJECT_START:
	"{";
	
terminal OBJECT_END:
	"}";
				

				